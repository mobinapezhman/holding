using Dapper;
using Microsoft.Data.SqlClient;
using Newtonsoft.Json;
using System.Collections.Generic;
using WebApplication1.Models;

namespace WebApplication1.Repository
{
    public class RepositoryDW
    {
        public string query = "SELECT * FROM [HoldingDW].[dbo].[VW_Report_KpiGroupScore]";
        public List<DashboardDataModel> kpis = new List<Models.DashboardDataModel>();
        public SqlConnection connection ;
       // string connectionstring = "Data Source=localhost;Initial Catalog=holding;user ID=sa;password=123456;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True";
        public RepositoryDW() 
        {
            //connection = new SqlConnection(connectionstring);
            
        }

        public string GetData()
        {
            var list = connection.Query<DashboardDataModel>(query).ToList();
            return JsonConvert.SerializeObject(list);
        }

        public List<DashboardDataModel> GetDataModel()
        {
            //var list = connection.Query<DashboardDataModel>(query).ToList();
            // var list2 = GetData();
            string f = "[{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":1,\"CompanyTitle\":\"شرکت هلدینگ بهسازان فردا\",\"ParentId\":0,\"UnitTitle\":\"شرکت هلدینگ بهسازان فردا\",\"UnitParentId\":1,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":null,\"KpiGroupScore\":0},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":15},{\"CompanyId\":2,\"CompanyTitle\":\"شرکت بهسازان ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت بهسازان ملت\",\"UnitParentId\":2,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":4},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":3,\"CompanyTitle\":\"شرکت به پرداخت ملت\",\"ParentId\":1,\"UnitTitle\":\"شرکت به پرداخت ملت\",\"UnitParentId\":3,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":51},{\"CompanyId\":4,\"CompanyTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی سیستم یاس ارغوانی\",\"UnitParentId\":4,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":5,\"CompanyTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی صنایع یاس ارغوانی\",\"UnitParentId\":5,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":0},{\"CompanyId\":6,\"CompanyTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"ParentId\":1,\"UnitTitle\":\"شرکت زیر ساخت امن خدمات تراکنشی\",\"UnitParentId\":6,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":1,\"KpiGroupTitle\":\"طرح و برنامه\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":2,\"KpiGroupTitle\":\"توسعه کسب و کار\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":3},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":3,\"KpiGroupTitle\":\"مالی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":4,\"KpiGroupTitle\":\"سرمایه گذاری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":5,\"KpiGroupTitle\":\"نوآوری\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":1},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":6,\"KpiGroupTitle\":\"منابع انسانی\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":4},{\"CompanyId\":7,\"CompanyTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"ParentId\":1,\"UnitTitle\":\"شرکت مهندسی نرم افزار شقایق\",\"UnitParentId\":7,\"KpiGroupId\":7,\"KpiGroupTitle\":\"امنیت اطلاعات\",\"DimDatePersianDate\":\"1402/05/31\",\"KpiGroupScore\":2}]\r\n";
            var list3 = JsonConvert.DeserializeObject<List<DashboardDataModel>>(f);
            var j = JsonConvert.SerializeObject(list3);
           return list3;
        }


    }
}
